{
  "name": "google-slides-automation-webhook",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "generate-slides",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "216ebc93-1705-4c9b-945f-f2ec2b5ca15a",
      "name": "Webhook Trigger",
      "type": "n8n-nodes-base.webhook",
      "position": [
        -1312,
        144
      ],
      "typeVersion": 2,
      "webhookId": "dynamic-slides-webhook"
    },
    {
      "parameters": {
        "operation": "copy",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.body.template_id }}",
          "mode": "id"
        },
        "name": "={{ $json.body.presentation_title }}_{{ $now.format('yyyy-MM-dd_HH-mm') }}",
        "sameFolder": false,
        "driveId": {
          "__rl": true,
          "value": "0AMWRtiy_gkUWUk9PVA",
          "mode": "list"
        },
        "folderId": {
          "__rl": true,
          "value": "1n908D9XciS0pMa0Y9ZfJbBkL78r6p7pK",
          "mode": "list"
        },
        "options": {}
      },
      "id": "e0e3882f-ae45-4666-84bc-31ac00f68583",
      "name": "Create Presentation Copy",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        -1088,
        144
      ],
      "typeVersion": 3,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "NVRmrBBlSe0wKY4k",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ğŸš€ å‹•æ…‹æº–å‚™æŠ•å½±ç‰‡è¤‡è£½è³‡æ–™ - æ”¯æ´ä»»ä½•æ¬„ä½çµæ§‹\n\nconst webhookData = $('Webhook Trigger').first().json.body;\nconst slides = webhookData.slides;\nconst presentation = $input.first().json;\nconst presentationId = presentation.presentationId;\n\n// å–å¾—æ¨¡æ¿æŠ•å½±ç‰‡çµæ§‹\nconst templateSlide = presentation.slides && presentation.slides[0] ? presentation.slides[0] : null;\n\nif (!templateSlide) {\n  throw new Error('æ‰¾ä¸åˆ°æ¨¡æ¿æŠ•å½±ç‰‡');\n}\n\n// ğŸ” å‹•æ…‹åˆ†ææ¨¡æ¿ä¸­çš„æ‰€æœ‰ placeholder\n// æƒææ‰€æœ‰æ–‡å­—å…ƒç´ æ‰¾å‡º {{}} æ ¼å¼çš„ placeholder\nconst textPlaceholders = new Set();\nconst imagePlaceholders = new Set();\n\n// æƒææ–‡å­—å…ƒç´ \nif (templateSlide.pageElements) {\n  templateSlide.pageElements.forEach(element => {\n    // è™•ç†å½¢ç‹€ä¸­çš„æ–‡å­—\n    if (element.shape && element.shape.text && element.shape.text.textElements) {\n      element.shape.text.textElements.forEach(textElement => {\n        if (textElement.textRun && textElement.textRun.content) {\n          const content = textElement.textRun.content;\n          const matches = content.match(/{{\\s*([A-Za-z0-9_]+)\\s*}}/g);\n          if (matches) {\n            matches.forEach(match => {\n              const placeholder = match.replace(/{{\\s*/, '').replace(/\\s*}}/, '');\n              textPlaceholders.add(placeholder);\n            });\n          }\n        }\n      });\n    }\n    \n    // è™•ç†è¡¨æ ¼ä¸­çš„æ–‡å­—\n    if (element.table && element.table.tableRows) {\n      element.table.tableRows.forEach(row => {\n        if (row.tableCells) {\n          row.tableCells.forEach(cell => {\n            if (cell.text && cell.text.textElements) {\n              cell.text.textElements.forEach(textElement => {\n                if (textElement.textRun && textElement.textRun.content) {\n                  const content = textElement.textRun.content;\n                  const matches = content.match(/{{\\s*([A-Za-z0-9_]+)\\s*}}/g);\n                  if (matches) {\n                    matches.forEach(match => {\n                      const placeholder = match.replace(/{{\\s*/, '').replace(/\\s*}}/, '');\n                      textPlaceholders.add(placeholder);\n                    });\n                  }\n                }\n              });\n            }\n          });\n        }\n      });\n    }\n    \n    // è™•ç†åœ–ç‰‡å…ƒç´  - æª¢æŸ¥ description æˆ– title ä¸­çš„ placeholder\n    if (element.image) {\n      const description = element.description || '';\n      const title = element.title || '';\n      \n      // æª¢æŸ¥ description ä¸­çš„ placeholder\n      if (description.includes('{{') && description.includes('}}')) {\n        const matches = description.match(/{{\\s*([A-Za-z0-9_]+)\\s*}}/g);\n        if (matches) {\n          matches.forEach(match => {\n            const placeholder = match.replace(/{{\\s*/, '').replace(/\\s*}}/, '');\n            imagePlaceholders.add(placeholder);\n          });\n        }\n      }\n      \n      // æª¢æŸ¥ title ä¸­çš„ placeholder\n      if (title.includes('{{') && title.includes('}}')) {\n        const matches = title.match(/{{\\s*([A-Za-z0-9_]+)\\s*}}/g);\n        if (matches) {\n          matches.forEach(match => {\n            const placeholder = match.replace(/{{\\s*/, '').replace(/\\s*}}/, '');\n            imagePlaceholders.add(placeholder);\n          });\n        }\n      }\n    }\n  });\n}\n\n// ğŸ§  åˆ†æ API è³‡æ–™çµæ§‹ï¼Œè‡ªå‹•åŒ¹é…æ¬„ä½\nconst allPlaceholders = new Set([...textPlaceholders, ...imagePlaceholders]);\nconst detectedFields = new Set();\n\nif (slides.length > 0) {\n  const sampleSlide = slides[0];\n  Object.keys(sampleSlide).forEach(key => {\n    detectedFields.add(key);\n  });\n}\n\n// å»ºç«‹æŠ•å½±ç‰‡è¤‡è£½è«‹æ±‚\nconst totalSlides = slides.length;\nconst availableSlides = 1; // æ¨¡æ¿åªæœ‰ä¸€å¼µæŠ•å½±ç‰‡\nconst duplicateRequests = [];\n\nif (totalSlides > availableSlides) {\n  const duplicateCount = totalSlides - availableSlides;\n  for (let i = 0; i < duplicateCount; i++) {\n    duplicateRequests.push({\n      duplicateObject: {\n        objectId: templateSlide.objectId\n        // ä¸æŒ‡å®šæ–° IDï¼Œè®“ Google Slides è‡ªå‹•ç”¢ç”Ÿ\n      }\n    });\n  }\n}\n\n// æº–å‚™ä¸‹ä¸€éšæ®µéœ€è¦çš„è³‡æ–™\nreturn {\n  presentationId: presentationId,\n  duplicateRequests: duplicateRequests,\n  needsDuplication: duplicateRequests.length > 0,\n  slidesData: slides,\n  templateSlide: templateSlide,\n  totalSlides: totalSlides,\n  // ğŸ¯ æ–°å¢å‹•æ…‹åˆ†æçµæœ\n  detectedTextPlaceholders: Array.from(textPlaceholders),\n  detectedImagePlaceholders: Array.from(imagePlaceholders),\n  detectedApiFields: Array.from(detectedFields),\n  allPlaceholders: Array.from(allPlaceholders),\n  mappingInfo: {\n    templatePlaceholders: Array.from(allPlaceholders),\n    apiFields: Array.from(detectedFields),\n    unmatchedPlaceholders: Array.from(allPlaceholders).filter(p => !detectedFields.has(p)),\n    unmatchedApiFields: Array.from(detectedFields).filter(f => !allPlaceholders.has(f))\n  }\n};"
      },
      "id": "eefc760a-177e-4814-8e13-9b83c8fb9fc1",
      "name": "Dynamic Template Analysis",
      "type": "n8n-nodes-base.code",
      "position": [
        -640,
        144
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "needs-duplication",
              "leftValue": "={{ $json.needsDuplication }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equal"
              }
            }
          ]
        },
        "options": {}
      },
      "id": "33070c6e-b58f-416e-a62d-06e14a9aca76",
      "name": "Need More Slides?",
      "type": "n8n-nodes-base.if",
      "position": [
        -416,
        144
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://slides.googleapis.com/v1/presentations/{{ $json.presentationId }}:batchUpdate",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googleApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"requests\": {{ JSON.stringify($json.duplicateRequests) }}\n}",
        "options": {}
      },
      "id": "f8d9fbc1-ea1a-4faf-b5c7-013960efc370",
      "name": "Duplicate Slides Only",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -192,
        64
      ],
      "typeVersion": 4.2,
      "credentials": {
        "googleApi": {
          "id": "Pcdnjn1yjSelE68O",
          "name": "Google SA - Slides Automation"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "get",
        "presentationId": "={{ $('Dynamic Template Analysis').first().json.presentationId }}"
      },
      "type": "n8n-nodes-base.googleSlides",
      "typeVersion": 2,
      "position": [
        32,
        144
      ],
      "id": "371a5513-63cb-41aa-a127-56095afc019d",
      "name": "Read Full Presentation",
      "credentials": {
        "googleApi": {
          "id": "Pcdnjn1yjSelE68O",
          "name": "Google SA - Slides Automation"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ğŸš€ å‹•æ…‹æº–å‚™æ‰€æœ‰å…§å®¹æ›¿æ›è«‹æ±‚ - æ”¯æ´ä»»ä½•æ¬„ä½çµæ§‹\n\nconst prepData = $('Dynamic Template Analysis').first().json;\nconst updatedPresentation = $input.first().json;\nconst slides = prepData.slidesData;\n\n// å–å¾—å‹•æ…‹åˆ†æçš„çµæœ\nconst textPlaceholders = prepData.detectedTextPlaceholders || [];\nconst imagePlaceholders = prepData.detectedImagePlaceholders || [];\nconst apiFields = prepData.detectedApiFields || [];\n\n// å»ºç«‹æ‰€æœ‰å…§å®¹æ›¿æ›è«‹æ±‚\nconst allRequests = [];\nconst processLog = [];\n\n// ğŸ§  æ™ºèƒ½æ¬„ä½åŒ¹é…å‡½å¼\nfunction findBestMatch(placeholder, availableFields) {\n  // 1. å®Œå…¨åŒ¹é…\n  if (availableFields.includes(placeholder)) {\n    return placeholder;\n  }\n  \n  // 2. å¿½ç•¥å¤§å°å¯«åŒ¹é…\n  const lowerPlaceholder = placeholder.toLowerCase();\n  const exactMatch = availableFields.find(field => field.toLowerCase() === lowerPlaceholder);\n  if (exactMatch) {\n    return exactMatch;\n  }\n  \n  // 3. éƒ¨åˆ†åŒ¹é…ï¼ˆåŒ…å«é—œä¿‚ï¼‰\n  const partialMatch = availableFields.find(field => \n    field.toLowerCase().includes(lowerPlaceholder) || \n    lowerPlaceholder.includes(field.toLowerCase())\n  );\n  if (partialMatch) {\n    return partialMatch;\n  }\n  \n  // 4. èªç¾©åŒ¹é…ï¼ˆå¸¸è¦‹åˆ¥åï¼‰\n  const synonymMap = {\n    'title': ['main_title', 'heading', 'header', 'subject'],\n    'subtitle': ['sub_title', 'subheading', 'description'],\n    'content': ['text', 'body', 'detail'],\n    'image': ['img', 'picture', 'photo', 'image_url'],\n    'bullet1': ['point1', 'item1', 'first', 'bullet_1'],\n    'bullet2': ['point2', 'item2', 'second', 'bullet_2'],\n    'bullet3': ['point3', 'item3', 'third', 'bullet_3']\n  };\n  \n  for (const [key, synonyms] of Object.entries(synonymMap)) {\n    if (lowerPlaceholder.includes(key) || synonyms.some(syn => lowerPlaceholder.includes(syn))) {\n      const match = availableFields.find(field => {\n        const lowerField = field.toLowerCase();\n        return lowerField.includes(key) || synonyms.some(syn => lowerField.includes(syn));\n      });\n      if (match) return match;\n    }\n  }\n  \n  return null;\n}\n\n// è™•ç†æ¯å¼µæŠ•å½±ç‰‡çš„å…§å®¹ï¼ˆä½¿ç”¨å¯¦éš›çš„æŠ•å½±ç‰‡ IDï¼‰\nslides.forEach((slideDataItem, index) => {\n  // å¾æ›´æ–°å¾Œçš„ç°¡å ±çµæ§‹ä¸­å–å¾—å¯¦éš›çš„æŠ•å½±ç‰‡ ID\n  const currentSlide = updatedPresentation.slides[index];\n  if (!currentSlide) return;\n  \n  const slideId = currentSlide.objectId;\n  const slideLog = { slideIndex: index, slideId, textReplacements: [], imageReplacements: [] };\n  \n  // ğŸ”¤ å‹•æ…‹æ–‡å­—æ›¿æ›è«‹æ±‚\n  textPlaceholders.forEach(placeholder => {\n    const matchedField = findBestMatch(placeholder, Object.keys(slideDataItem));\n    \n    if (matchedField && slideDataItem[matchedField] !== undefined) {\n      const value = slideDataItem[matchedField];\n      \n      // åªè™•ç†éç©ºå€¼\n      if (value !== null && value !== undefined && value.toString().trim() !== '') {\n        allRequests.push({\n          replaceAllText: {\n            containsText: {\n              text: `{{${placeholder}}}`,\n              matchCase: false\n            },\n            replaceText: value.toString().trim(),\n            pageObjectIds: [slideId]\n          }\n        });\n        \n        slideLog.textReplacements.push({\n          placeholder: `{{${placeholder}}}`,\n          matchedField: matchedField,\n          value: value.toString().trim()\n        });\n      }\n    } else {\n      // è¨˜éŒ„æœªåŒ¹é…çš„ placeholder\n      slideLog.textReplacements.push({\n        placeholder: `{{${placeholder}}}`,\n        matchedField: null,\n        status: 'no_match'\n      });\n    }\n  });\n  \n  // ğŸ–¼ï¸ å‹•æ…‹åœ–ç‰‡æ›¿æ›è«‹æ±‚\n  imagePlaceholders.forEach(placeholder => {\n    const matchedField = findBestMatch(placeholder, Object.keys(slideDataItem));\n    \n    if (matchedField && slideDataItem[matchedField]) {\n      const imageUrl = slideDataItem[matchedField];\n      \n      // é©—è­‰æ˜¯å¦ç‚ºæœ‰æ•ˆçš„ URL\n      if (imageUrl && imageUrl.toString().trim() !== '' && \n          (imageUrl.toString().startsWith('http://') || imageUrl.toString().startsWith('https://'))) {\n        \n        // æ‰¾å‡ºè©²æŠ•å½±ç‰‡ä¸­ç¬¦åˆæ­¤ placeholder çš„åœ–ç‰‡å…ƒç´ \n        const imageElements = currentSlide.pageElements.filter(element => {\n          if (!element.image) return false;\n          \n          // æª¢æŸ¥ description æˆ– title æ˜¯å¦åŒ…å«æ­¤ placeholder\n          const description = element.description || '';\n          const title = element.title || '';\n          \n          return description.includes(`{{${placeholder}}}`) || title.includes(`{{${placeholder}}}`);\n        });\n        \n        imageElements.forEach(imageElement => {\n          allRequests.push({\n            replaceImage: {\n              imageObjectId: imageElement.objectId,\n              imageReplaceMethod: 'CENTER_CROP',\n              url: imageUrl.toString()\n            }\n          });\n          \n          slideLog.imageReplacements.push({\n            placeholder: `{{${placeholder}}}`,\n            matchedField: matchedField,\n            imageUrl: imageUrl.toString(),\n            elementId: imageElement.objectId\n          });\n        });\n      }\n    } else {\n      // è¨˜éŒ„æœªåŒ¹é…çš„åœ–ç‰‡ placeholder\n      slideLog.imageReplacements.push({\n        placeholder: `{{${placeholder}}}`,\n        matchedField: null,\n        status: 'no_match'\n      });\n    }\n  });\n  \n  processLog.push(slideLog);\n});\n\n// ğŸ¯ è™•ç†å®Œå…¨å‹•æ…‹çš„æ¬„ä½ï¼ˆAPI ä¸­æœ‰ä½†æ¨¡æ¿ä¸­æ²’æœ‰ placeholder çš„ï¼‰\nconst unusedFields = apiFields.filter(field => \n  !textPlaceholders.some(p => findBestMatch(p, [field])) &&\n  !imagePlaceholders.some(p => findBestMatch(p, [field]))\n);\n\nreturn {\n  presentationId: prepData.presentationId,\n  allRequests: allRequests,\n  totalOperations: allRequests.length,\n  textOperations: allRequests.filter(req => req.replaceAllText).length,\n  imageOperations: allRequests.filter(req => req.replaceImage).length,\n  slidesProcessed: slides.length,\n  // ğŸ” è©³ç´°çš„è™•ç†è³‡è¨Š\n  processingDetails: {\n    templateAnalysis: {\n      textPlaceholders: textPlaceholders,\n      imagePlaceholders: imagePlaceholders,\n      totalPlaceholders: textPlaceholders.length + imagePlaceholders.length\n    },\n    apiAnalysis: {\n      detectedFields: apiFields,\n      unusedFields: unusedFields\n    },\n    matchingResults: processLog,\n    summary: {\n      successfulTextMatches: processLog.reduce((sum, log) => \n        sum + log.textReplacements.filter(r => r.status !== 'no_match').length, 0),\n      successfulImageMatches: processLog.reduce((sum, log) => \n        sum + log.imageReplacements.filter(r => r.status !== 'no_match').length, 0),\n      unmatchedTextPlaceholders: processLog.reduce((sum, log) => \n        sum + log.textReplacements.filter(r => r.status === 'no_match').length, 0),\n      unmatchedImagePlaceholders: processLog.reduce((sum, log) => \n        sum + log.imageReplacements.filter(r => r.status === 'no_match').length, 0)\n    }\n  }\n};"
      },
      "id": "da20870d-98ba-43df-a1a9-c3421e5120ca",
      "name": "Smart Content Mapping",
      "type": "n8n-nodes-base.code",
      "position": [
        256,
        144
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://slides.googleapis.com/v1/presentations/{{ $json.presentationId }}:batchUpdate",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googleApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"requests\": {{ JSON.stringify($json.allRequests) }}\n}",
        "options": {}
      },
      "id": "91a73284-952b-47ad-8be6-6ed0728dc582",
      "name": "Execute All Updates",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        480,
        144
      ],
      "typeVersion": 4.2,
      "credentials": {
        "googleApi": {
          "id": "Pcdnjn1yjSelE68O",
          "name": "Google SA - Slides Automation"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"message\": \"âœ… å‹•æ…‹ç°¡å ±ç”ŸæˆæˆåŠŸ\",\n  \"presentation_id\": \"{{ $('Smart Content Mapping').first().json.presentationId }}\",\n  \"presentation_url\": \"https://docs.google.com/presentation/d/{{ $('Smart Content Mapping').first().json.presentationId }}/edit\",\n  \"slide_count\": {{ $('Smart Content Mapping').first().json.slidesProcessed }},\n  \"operations_performed\": {\n    \"text_operations\": {{ $('Smart Content Mapping').first().json.textOperations }},\n    \"image_operations\": {{ $('Smart Content Mapping').first().json.imageOperations }},\n    \"total_operations\": {{ $('Smart Content Mapping').first().json.totalOperations }}\n  },\n  \"dynamic_analysis\": {\n    \"detected_placeholders\": {{ JSON.stringify($('Smart Content Mapping').first().json.processingDetails.templateAnalysis.textPlaceholders.concat($('Smart Content Mapping').first().json.processingDetails.templateAnalysis.imagePlaceholders)) }},\n    \"api_fields\": {{ JSON.stringify($('Smart Content Mapping').first().json.processingDetails.apiAnalysis.detectedFields) }},\n    \"unused_fields\": {{ JSON.stringify($('Smart Content Mapping').first().json.processingDetails.apiAnalysis.unusedFields) }},\n    \"matching_summary\": {\n      \"successful_text_matches\": {{ $('Smart Content Mapping').first().json.processingDetails.summary.successfulTextMatches }},\n      \"successful_image_matches\": {{ $('Smart Content Mapping').first().json.processingDetails.summary.successfulImageMatches }},\n      \"unmatched_placeholders\": {{ $('Smart Content Mapping').first().json.processingDetails.summary.unmatchedTextPlaceholders + $('Smart Content Mapping').first().json.processingDetails.summary.unmatchedImagePlaceholders }}\n    }\n  },\n  \"features\": {\n    \"dynamic_field_detection\": true,\n    \"smart_placeholder_matching\": true,\n    \"multi_image_support\": true,\n    \"table_text_support\": true,\n    \"synonym_matching\": true,\n    \"detailed_processing_log\": true\n  },\n  \"created_at\": \"{{ $now.toISO() }}\",\n  \"version\": \"v2-dynamic\",\n  \"note\": \"å®Œå…¨å‹•æ…‹çš„ç°¡å ±ç”Ÿæˆç³»çµ±ï¼šè‡ªå‹•åˆ†ææ¨¡æ¿çµæ§‹ã€æ™ºèƒ½åŒ¹é… API æ¬„ä½ã€æ”¯æ´ä»»ä½• placeholder åç¨±\"\n}",
        "options": {
          "responseCode": 200
        }
      },
      "id": "136fe1d9-7372-4447-a815-a0585040c0fd",
      "name": "Enhanced Success Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "position": [
        704,
        144
      ],
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "get",
        "presentationId": "={{ $json.id }}"
      },
      "type": "n8n-nodes-base.googleSlides",
      "typeVersion": 2,
      "position": [
        -864,
        144
      ],
      "id": "16d4364b-6436-4c04-94d3-16508dc315db",
      "name": "Read Template Structure",
      "credentials": {
        "googleApi": {
          "id": "Pcdnjn1yjSelE68O",
          "name": "Google SA - Slides Automation"
        }
      }
    },
    {
      "parameters": {
        "content": "# ğŸ“¥ API Request æ ¼å¼\n\n**HTTP Method:** POST\n**Endpoint:** `/generate-slides`\n\n**Request Body çµæ§‹ç¯„ä¾‹:**\n```json\n{\n  \"template_id\": \"1ABC123..._template_id\",\n  \"presentation_title\": \"æˆ‘çš„å‹•æ…‹ç°¡å ±\",\n  \"slides\": [\n    {\n      \"title\": \"ç¬¬ä¸€å¼µæŠ•å½±ç‰‡æ¨™é¡Œ\",\n      \"subtitle\": \"å‰¯æ¨™é¡Œå…§å®¹\",\n      \"content\": \"ä¸»è¦å…§å®¹æè¿°\",\n      \"bullet1\": \"é‡é»ä¸€\",\n      \"bullet2\": \"é‡é»äºŒ\",\n      \"image_url\": \"https://example.com/image1.jpg\"\n    },\n    {\n      \"title\": \"ç¬¬äºŒå¼µæŠ•å½±ç‰‡æ¨™é¡Œ\",\n      \"description\": \"è©³ç´°èªªæ˜æ–‡å­—\",\n      \"chart_data\": \"åœ–è¡¨è³‡æ–™\",\n      \"background_image\": \"https://example.com/bg.jpg\"\n    }\n  ]\n}\n```\n\n**é‡è¦èªªæ˜:**\nâ€¢ `template_id`: Google Slides æ¨¡æ¿çš„æª”æ¡ˆ ID\nâ€¢ `presentation_title`: æ–°ç°¡å ±çš„åç¨±\nâ€¢ `slides`: æŠ•å½±ç‰‡è³‡æ–™é™£åˆ—ï¼Œæ”¯æ´ä»»ä½•å‹•æ…‹æ¬„ä½\nâ€¢ æ¯å€‹ slide ç‰©ä»¶å¯åŒ…å«ä»»æ„æ¬„ä½åç¨±\nâ€¢ ç³»çµ±æœƒè‡ªå‹•åµæ¸¬æ¨¡æ¿ä¸­çš„ `{{placeholder}}` ä¸¦æ™ºèƒ½åŒ¹é…\nâ€¢ æ”¯æ´æ–‡å­—æ›¿æ›å’Œåœ–ç‰‡ URL æ›¿æ›",
        "height": 716,
        "width": 608
      },
      "id": "ad915945-933b-4835-9a5d-ed71ba646b6c",
      "name": "API Request èªªæ˜",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1312,
        -752
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“¤ API Response æ ¼å¼\n\n**æˆåŠŸå›æ‡‰çµæ§‹:**\n```json\n{\n  \"success\": true,\n  \"message\": \"âœ… å‹•æ…‹ç°¡å ±ç”ŸæˆæˆåŠŸ\",\n  \"presentation_id\": \"1ABC123...\",\n  \"presentation_url\": \"https://docs.google.com/presentation/d/1ABC123.../edit\",\n  \"slide_count\": 3,\n  \"operations_performed\": {\n    \"text_operations\": 12,\n    \"image_operations\": 2,\n    \"total_operations\": 14\n  },\n  \"dynamic_analysis\": {\n    \"detected_placeholders\": [\"title\", \"content\", \"image\"],\n    \"api_fields\": [\"title\", \"subtitle\", \"content\"],\n    \"unused_fields\": [],\n    \"matching_summary\": {\n      \"successful_text_matches\": 10,\n      \"successful_image_matches\": 2,\n      \"unmatched_placeholders\": 0\n    }\n  },\n  \"created_at\": \"2024-01-15T10:30:00Z\",\n  \"version\": \"v2-dynamic\"\n}\n```\n\n**éŒ¯èª¤è™•ç†:**\nâ€¢ HTTP 400: è«‹æ±‚æ ¼å¼éŒ¯èª¤\nâ€¢ HTTP 403: æ¬Šé™ä¸è¶³æˆ–æ¨¡æ¿ç„¡æ³•å­˜å–\nâ€¢ HTTP 500: å…§éƒ¨è™•ç†éŒ¯èª¤\nâ€¢ è©³ç´°éŒ¯èª¤è¨Šæ¯æœƒåŒ…å«åœ¨ response body ä¸­",
        "height": 696,
        "width": 836
      },
      "id": "c701734b-25ef-4d7d-976f-a8da1862621d",
      "name": "API Response èªªæ˜",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        352,
        -752
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ§  æ™ºèƒ½æ¬„ä½åŒ¹é…é‚è¼¯\n\n**è‡ªå‹•åµæ¸¬æµç¨‹:**\n1. **æ¨¡æ¿æƒæ**: è‡ªå‹•åˆ†ææ¨¡æ¿ä¸­æ‰€æœ‰ `{{placeholder}}` æ ¼å¼\n2. **API çµæ§‹åˆ†æ**: å‹•æ…‹åˆ†æè¼¸å…¥è³‡æ–™çš„æ¬„ä½çµæ§‹\n3. **æ™ºèƒ½åŒ¹é…ç®—æ³•**: å¤šå±¤æ¬¡åŒ¹é…ç­–ç•¥\n\n**åŒ¹é…å„ªå…ˆé †åº:**\nâ€¢ **å®Œå…¨åŒ¹é…**: `{{title}}` â†” `title`\nâ€¢ **å¿½ç•¥å¤§å°å¯«**: `{{Title}}` â†” `title`\nâ€¢ **éƒ¨åˆ†åŒ¹é…**: `{{main_title}}` â†” `title`\nâ€¢ **èªç¾©åŒ¹é…**: `{{subtitle}}` â†” `sub_title`\n\n**æ”¯æ´çš„å…§å®¹é¡å‹:**\nâœ… æ–‡å­—å…§å®¹ (å½¢ç‹€ã€è¡¨æ ¼)\nâœ… åœ–ç‰‡æ›¿æ› (ä½¿ç”¨ URL)\nâœ… å¤šå±¤åµŒå¥—çµæ§‹\nâœ… å‹•æ…‹æ¬„ä½åç¨±\n\n**æ™ºèƒ½åŠŸèƒ½:**\nâ€¢ è‡ªå‹•è­˜åˆ¥æœªä½¿ç”¨çš„ API æ¬„ä½\nâ€¢ è¨˜éŒ„æœªåŒ¹é…çš„ placeholder\nâ€¢ æä¾›è©³ç´°çš„è™•ç†æ—¥èªŒ\nâ€¢ æ”¯æ´åŒç¾©è©å°æ‡‰ (title/heading/subject)",
        "height": 528,
        "width": 412
      },
      "id": "6a6034d9-0dfd-4c0e-899d-11546d4936c0",
      "name": "æ™ºèƒ½æ¬„ä½åŒ¹é…èªªæ˜",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -112,
        -576
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“‘ æŠ•å½±ç‰‡è¤‡è£½æ©Ÿåˆ¶\n\n**å‹•æ…‹è¤‡è£½é‚è¼¯:**\nâ€¢ ç³»çµ±è‡ªå‹•æ¯”è¼ƒ API è«‹æ±‚ä¸­çš„æŠ•å½±ç‰‡æ•¸é‡èˆ‡æ¨¡æ¿æŠ•å½±ç‰‡æ•¸é‡\nâ€¢ ç•¶éœ€è¦çš„æŠ•å½±ç‰‡æ•¸ > æ¨¡æ¿æŠ•å½±ç‰‡æ•¸æ™‚ï¼Œè‡ªå‹•è§¸ç™¼è¤‡è£½\n\n**è¤‡è£½æµç¨‹:**\n1. **æ•¸é‡åˆ¤æ–·**: åˆ†æ `slides` é™£åˆ—é•·åº¦\n2. **æ¨¡æ¿åŸºæº–**: ä»¥ç¬¬ä¸€å¼µæŠ•å½±ç‰‡ç‚ºè¤‡è£½ç¯„æœ¬\n3. **æ‰¹æ¬¡è¤‡è£½**: ä½¿ç”¨ Google Slides API æ‰¹æ¬¡å»ºç«‹\n4. **ID ç®¡ç†**: è‡ªå‹•ç”¢ç”Ÿæ–°çš„æŠ•å½±ç‰‡ ID\n\n**ç¯„ä¾‹å ´æ™¯:**\nâ€¢ æ¨¡æ¿æœ‰ 1 å¼µæŠ•å½±ç‰‡ï¼ŒAPI è¦æ±‚ 3 å¼µ â†’ è¤‡è£½ 2 å¼µ\nâ€¢ æ¨¡æ¿æœ‰ 2 å¼µæŠ•å½±ç‰‡ï¼ŒAPI è¦æ±‚ 5 å¼µ â†’ è¤‡è£½ 3 å¼µ\nâ€¢ æ¨¡æ¿æŠ•å½±ç‰‡æ•¸ â‰¥ éœ€æ±‚æ•¸ â†’ ä¸é€²è¡Œè¤‡è£½\n\n**å…§å®¹ç¨ç«‹æ€§:**\nâœ… æ¯å¼µæŠ•å½±ç‰‡ç²å¾—ç¨ç«‹çš„å…§å®¹\nâœ… placeholder æ›¿æ›äº’ä¸å½±éŸ¿\nâœ… ä¿æŒåŸå§‹æ¨¡æ¿æ ¼å¼å’Œæ¨£å¼",
        "height": 472,
        "width": 488
      },
      "id": "6ac79f9a-06cb-4e7e-94ab-ac94fb5dc44b",
      "name": "æŠ•å½±ç‰‡è¤‡è£½æ©Ÿåˆ¶",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -656,
        -512
      ],
      "typeVersion": 1
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook Trigger": {
      "main": [
        [
          {
            "node": "Create Presentation Copy",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Presentation Copy": {
      "main": [
        [
          {
            "node": "Read Template Structure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Dynamic Template Analysis": {
      "main": [
        [
          {
            "node": "Need More Slides?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Need More Slides?": {
      "main": [
        [
          {
            "node": "Duplicate Slides Only",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Read Full Presentation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Duplicate Slides Only": {
      "main": [
        [
          {
            "node": "Read Full Presentation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Full Presentation": {
      "main": [
        [
          {
            "node": "Smart Content Mapping",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Smart Content Mapping": {
      "main": [
        [
          {
            "node": "Execute All Updates",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute All Updates": {
      "main": [
        [
          {
            "node": "Enhanced Success Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Template Structure": {
      "main": [
        [
          {
            "node": "Dynamic Template Analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "a9764e1d-2ef3-43b6-bef9-cf0ba6bb538c",
  "meta": {
    "instanceId": "888a8c05da76b495dd9ecfb59aacefd871c48ab4e43409e77d226b344d9412b4"
  },
  "id": "uEDcB1fDsMnjsbxR",
  "tags": [
    {
      "name": "Google Slides",
      "id": "mEvoEJt2XcH9bHp3",
      "createdAt": "2025-08-13T04:55:13.452Z",
      "updatedAt": "2025-08-13T04:55:13.452Z"
    },
    {
      "name": "Document Automation",
      "id": "klKhMJmShCNYhlJR",
      "createdAt": "2025-08-13T04:55:21.739Z",
      "updatedAt": "2025-08-13T04:55:21.739Z"
    },
    {
      "name": "Webhook API",
      "id": "QEHrcs99j06x3gN0",
      "createdAt": "2025-08-13T04:55:35.351Z",
      "updatedAt": "2025-08-13T04:55:35.351Z"
    },
    {
      "createdAt": "2025-04-08T16:51:05.415Z",
      "updatedAt": "2025-04-08T16:51:05.415Z",
      "id": "Vdy12sJzDHe4wZVF",
      "name": "NF"
    }
  ]
}